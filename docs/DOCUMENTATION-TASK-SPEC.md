# Lumerical 命令文档整理任务规范

## 任务概述

### 背景
当前 `docs/lumapi/` 目录下包含 86 个 Lumerical 命令的 Markdown 文档。这些文档需要按照统一的质量标准进行整理、完善和验证，以确保技术准确性、格式一致性和实用性。

### 问题
- **上下文长度瓶颈**: 单个会话中处理全部 86 个文档会超过上下文长度限制
- **并行处理需求**: 文档整理工作可以并行进行以提高效率
- **质量一致性**: 需要确保所有文档遵循统一的标准

### 解决方案
1. 将 86 个文档分成多个块（chunks）
2. 为每个块创建独立的整理任务
3. 多个 AI agent 可以并行处理不同的块
4. 提供详细的任务规范和验收标准

## 文档质量标准

### 1. 结构模板（必须严格遵守）

所有命令文档必须遵循以下结构模板：

```markdown
# 命令名称

## 概述
[简要介绍命令的功能、用途和适用场景]

## 语法

### Lumerical 脚本语言 (LSF)
```lumerical
命令语法
```

### Python API (Lumapi)
```python
session.命令名称()
```

## 参数
[命令的直接参数说明，如果没有直接参数则说明需要通过 `set` 命令配置]

## 配置属性（如适用）
[通过 `set` 命令可配置的属性表格]

| 属性 | 类型 | 默认值 | 描述 |
|------|------|--------|------|
| `属性名` | 类型 | 默认值 | 详细描述 |

## 返回值
[命令的返回值说明]

## 示例

### 示例 1: [基本用法描述]
#### LSF 脚本
```lumerical
// 注释说明
命令代码
```

#### Python API
```python
# 注释说明
import lumapi
代码
```

### 示例 2: [中级用法描述]
[类似结构]

### 示例 3: [高级用法描述]
[类似结构]

## 注意事项
[使用该命令时的注意事项、常见陷阱、性能考虑等]

## 错误处理
[常见错误及其解决方案，Python 错误处理示例]

## 相关命令
- [相关命令 1](链接)
- [相关命令 2](链接)

## 产品支持
- **主要支持**: [产品名称]
- **可选支持**: [产品名称]
- **不支持**: [产品名称]

## 版本历史
| 版本 | 修改 |
|------|------|
| 版本号 | 修改内容 |

## 参考
1. [参考文档 1]
2. [参考文档 2]

---

*最后更新: YYYY-MM-DD*  
*文档版本: x.x*
```

### 2. 内容要求

#### 技术准确性 (权重: 40%)
- 命令语法必须与官方 Lumerical 文档一致
- 参数描述必须准确无误
- 示例代码必须在 Lumerical 中可运行（概念验证）
- 单位必须正确指定（默认单位为米）

#### 完整性 (权重: 25%)
- 必须包含 LSF 和 Python API 两种语法
- 必须提供 2-4 个示例（基本、中级、高级）
- 必须包含所有重要配置属性表格
- 必须列出相关命令和产品支持信息

#### 可读性 (权重: 20%)
- 使用清晰简洁的中文
- 技术术语首次出现时应提供简要解释
- 示例代码必须有详细注释
- 复杂概念应分步骤解释

#### 实用性 (权重: 15%)
- 示例应反映实际应用场景
- 应包含常见问题解决方案
- 应提供性能优化建议
- 应包含错误处理和调试技巧

### 3. 格式规范

#### 标题层级
- 一级标题: `# 命令名称`
- 二级标题: `## 章节名称`
- 三级标题: `### 子章节名称`
- 代码块标题: `#### 描述`

#### 代码块语言标识
- LSF 脚本: ```lumerical
- Python API: ```python
- 其他代码: ```相应语言

#### 表格格式
- 使用 Markdown 表格语法
- 属性名用反引号包裹：``属性名`
- 类型应准确：string, float, int, bool, array 等

#### 链接格式
- 内部链接: `[文本](./文件名.md)`
- 外部链接: `[文本](URL)`

## 整理流程

### 1. 文档分析阶段
1. 读取现有文档内容
2. 检查是否符合结构模板
3. 识别缺失的部分
4. 评估技术准确性

### 2. 内容完善阶段
1. 补充缺失的章节
2. 修正技术错误
3. 添加更多示例
4. 完善配置属性表格
5. 更新版本历史

### 3. 质量验证阶段
1. 检查格式一致性
2. 验证代码语法
3. 确保链接有效
4. 更新日期和版本号

### 4. 最终验收阶段
1. 整体质量评分
2. 生成改进报告
3. 标记为完成

## 质量评分标准

### 评分公式
```
总分 = (技术准确性×0.4) + (完整性×0.25) + (可读性×0.2) + (实用性×0.15)
```

### 质量等级
- **A (4.0-5.0)**: 优秀，可直接发布
- **B (3.0-3.9)**: 良好，需要少量改进  
- **C (2.0-2.9)**: 及格，需要显著改进
- **D (1.0-1.9)**: 不及格，需要重写

### 验收标准
- 所有文档必须达到 **B 级（3.0分）** 以上
- 关键命令文档（如 `addfdtd`, `addfde`, `addeme`）必须达到 **A 级（4.0分）** 以上
- 无技术性错误
- 格式完全一致

## 分块处理策略

### 分块原则
1. **功能相似性**: 将功能相似的命令放在同一块
2. **工作量均衡**: 每块包含 10-15 个文档
3. **依赖关系**: 考虑命令之间的依赖关系
4. **产品分类**: 按支持的产品分类（FDTD, MODE, DEVICE, INTERCONNECT）

### 分块方案
共 86 个文档，分为 8 个块，每块约 10-11 个文档：

1. **几何结构命令** (11个): 添加基本几何形状的命令
2. **求解器命令** (11个): 添加各种求解器的命令
3. **源和监视器命令** (11个): 添加源和监视器的命令
4. **材料命令** (10个): 材料和属性相关命令
5. **数学和工具命令** (11个): 数学计算和工具命令
6. **FDTD 专用命令** (11个): FDTD 特有的命令
7. **MODE 专用命令** (10个): MODE 特有的命令
8. **通用和脚本命令** (11个): 通用操作和脚本命令

### 分块记录
详细分块信息见 [DOCUMENTATION-CHUNKS.md](./DOCUMENTATION-CHUNKS.md)

## AI Agent 使用指南

### 任务获取
1. 读取本规范文档
2. 查看分块记录文档
3. 选择一个未分配的块
4. 在分块记录中标记为"处理中"

### 工作流程
1. **准备阶段**:
   - 读取分配到的所有文档
   - 分析现有内容质量
   - 制定改进计划

2. **执行阶段**:
   - 按文档逐个整理
   - 遵循结构模板
   - 确保技术准确性

3. **验证阶段**:
   - 检查格式一致性
   - 验证代码示例
   - 评分并记录

4. **提交阶段**:
   - 更新分块记录状态
   - 生成质量报告
   - 标记为"已完成"

### 工具使用
- **文件读取**: 使用 Read 工具读取文档
- **内容搜索**: 使用 Grep 工具搜索相关模式
- **文件编辑**: 使用 Edit 工具修改文档
- **批量操作**: 使用 Task 工具进行并行处理

### 质量保证
1. **交叉验证**: 与其他相关命令文档对比
2. **语法检查**: 验证代码语法正确性
3. **链接检查**: 确保所有链接有效
4. **版本更新**: 更新日期和版本号

## 进度跟踪

### 状态定义
- **未开始**: 文档尚未分配
- **处理中**: AI agent 正在整理
- **待审核**: 整理完成，等待审核
- **已完成**: 审核通过，质量达标
- **需重做**: 质量不达标，需要重新整理

### 进度报告
每个块完成后应生成进度报告：
1. 处理的文档数量
2. 平均质量分数
3. 主要改进内容
4. 遇到的问题和解决方案

## 常见问题处理

### 技术准确性不确定
1. 参考官方 Lumerical 文档
2. 检查现有脚本中的使用方式
3. 在分块记录中标记为"需要人工验证"
4. 提供替代的准确描述

### 示例代码不完整
1. 补充必要的导入语句
2. 添加详细注释
3. 确保代码逻辑完整
4. 提供运行上下文说明

### 格式不一致
1. 使用统一的表格格式
2. 标准化标题层级
3. 统一代码块语言标识
4. 检查并修复所有链接

### 链接失效
1. 更新为正确的相对路径
2. 如果目标文件不存在，创建占位符说明
3. 外部链接标记为可能需要更新

## 术语表

| 术语 | 定义 | 使用规范 |
|------|------|----------|
| LSF | Lumerical Script Language | 首字母大写，指 Lumerical 脚本语言 |
| Lumapi | Lumerical Python API | 首字母大写，指 Python API |
| FDTD | Finite-Difference Time-Domain | 全大写，指时域有限差分方法 |
| FDE | Finite-Difference Eigenmode | 全大写，指频域有限差分本征模式求解器 |
| EME | Eigenmode Expansion | 全大写，指本征模式扩展方法 |
| PML | Perfectly Matched Layer | 全大写，指完全匹配层边界条件 |
| GUI | Graphical User Interface | 全大写，指图形用户界面 |
| API | Application Programming Interface | 全大写，指应用程序编程接口 |

## 参考资源

### 内部资源
1. [文档质量标准和 AI 润色指南](./documentation-quality-standards.md)
2. [按字母顺序排列的脚本命令](./script-commands-alphabetical.md)
3. [按类别排列的脚本命令](./script-commands-by-category.md)
4. [Lumapi 原理文档](./lumapi-principles.md)

### 外部资源
1. Lumerical Script Language Reference (官方文档)
2. Lumerical Python API Documentation (官方文档)
3. Lumerical Knowledge Base (在线知识库)
4. Lumerical Forum (用户论坛)

### 工具资源
1. Markdown 语法检查工具
2. 代码语法高亮工具
3. 表格格式化工具
4. 链接验证工具

## 版本历史

| 版本 | 日期 | 修改说明 |
|------|------|----------|
| 1.0 | 2026-01-31 | 初始版本，定义任务规范和分块策略 |
| 1.1 | 2026-01-31 | 添加 AI Agent 使用指南和进度跟踪 |

---

*最后更新: 2026-01-31*  
*文档版本: 1.1*